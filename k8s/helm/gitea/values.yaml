# Default values for gitea.
tlsHostname: gitea.example.com
nodeportSSH: 30999
deployment:
  env:
    gitea__database__host: "db00:3306"
    gitea__database__name: gitea
    gitea__database__user: gitea
    gitea__mailer__from: git@example.com
    gitea__mailer__protocol: smtp
    gitea__mailer__smtp_addr: smtp
    gitea__service__disable_registration: "false"
    gitea__service__require_signin_view: "true"
    tz: UTC
    # runAsUser unsupported - leave these at default
    user_gid: 1000
    user_uid: 1000
  xenv:
  - name: gitea__database__passwd
    valueFrom:
      secretKeyRef:
        key: gitea-db-password
        name: gitea-db-password
  containerPorts:
  - containerPort: 2222
  - containerPort: 3000
  livenessProbe:
    httpGet:
      path: /api/healthz
      port: http
    initialDelaySeconds: 200
    timeoutSeconds: 5
    periodSeconds: 10
    successThreshold: 1
    failureThreshold: 10
  nodeSelector:
    service.gitea: allow
  resources:
    limits:
      memory: 2048Mi
    requests:
      cpu: 300m
      memory: 128Mi
volumeMounts:
- mountPath: /var/lib/gitea
  name: data
  subPath: data
- mountPath: /etc/gitea
  name: data
  subPath: etc
  # readOnly: true
volumes:
- name: data
  hostPath: { path: /var/lib/docker/k8s-volumes/share/gitea }

image:
  repository: gitea/gitea
  pullPolicy: IfNotPresent
  # tag: default

nameOverride: ""
fullnameOverride: ""

serviceAccount: {}
service:
service:
  clusterIP: None
  ports:
  - { port: 80, targetPort: 3000, name: gitea }
  - { port: 8999, targetPort: 2222, name: ssh }
  type: ClusterIP
autoscaling:
  enabled: false

authelia:
  fqdn: authtotp.example.com
  ip: 10.101.1.5
  path: /user/login
ingress:
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/enable-access-log: "false"
