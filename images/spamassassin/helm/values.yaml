# Default values for spamassassin.
statefulset:
  containerPorts: [ containerPort: 783 ]
  env:
    cron_hour: "1"
    cron_minute: "30"
    extra_options: --nouser-config --sql-config
    pyzor_site: "public.pyzor.org:24441"
    tz: UTC
  replicas: 3
  resources:
    limits:
      memory: 384Mi
    requests:
      cpu: 100m
      memory: 128Mi
volumeMounts:
- mountPath: /etc/mail/spamassassin/local.cf
  name: etc
  subPath: local.cf
- mountPath: /var/lib/spamassassin
  name: home
- mountPath: /var/log
  name: logs
volumes:
- name: etc
  configMap:
    name: spamassassin-etc
- name: logs
  emptyDir: {}
volumeClaimTemplates:
- metadata:
    name: home
  spec:
    accessModes: [ ReadWriteOnce ]
    resources:
      requests:
        storage: 50Mi

image:
  repository: instantlinux/spamassassin
  pullPolicy: IfNotPresent
  # tag: default

nameOverride: ""
fullnameOverride: ""

serviceAccount: {}
service:
  clusterIP: 10.101.1.50
  ports:
  - { port: 783, targetPort: 783 }
  type: clusterIP
autoscaling:
  enabled: false

configmap:
  name: spamassassin-etc
  data:
    local.cf: |
      # Autogenerated by helm
      #
      # This is the right place to customize your installation of SpamAssassin.
      # See 'perldoc Mail::SpamAssassin::Conf' for details of what can be
      # tweaked.
      #
      # RichB note: actually the above is only partly true.  A lot of
      # customizations are kept in the userpref table (MySQL).
      #
      ###########################################################################
      #
      ##allow_user_rules 1

      razor_config /var/lib/spamassassin/.razor/razor-agent.conf
      bayes_path /var/lib/spamassassin/.spamassassin/bayes
      use_bayes 1
      use_dcc 1
      dcc_home /var/dcc

      user_scores_dsn           DBI:mysql:spamassassin:db00
      user_scores_sql_username  spamassassin
      user_scores_sql_password  topsecret
